### AOP总结

---------

**概念**：AOP(Aspect Oriented Programming)面向切面编程，一种编程范式

**作用**：在不惊动原始设计的基础上为方法进行功能**增强**

**核心概念**

- **代理**（Proxy）：SpringAOP的核心本质是采用代理模式实现的
- **连接点**（JoinPoint）：在SpringAOP中，理解为任意方法的执行
- **切入点**（Pointcut）：匹配连接点的式子，也是具有共性功能的方法描述
- **通知**（Advice）：若干个方法的共性功能，在切入点处执行，最终体现为一个方法
- **切面**（Aspect）：描述通知与切入点的对应关系
- **目标对象**（Target）：被代理的原始对象称为目标对象

##### 切入点表达式标准格式

动作关键字（访问修饰符	返回值	包名.类/接口名.方法名(参数)异常名）

`execution(* org.service.*Service.*(..))`

##### 切入点表达式描述通配符

- 作用：用于快速描述，范围描述
- *：匹配任意符号
- ..：匹配多个连续的任意符号
- +：匹配子类类型

##### 切入点表达式书写技巧

1. 按**标准规范**开发
2. 查询操作的返回值建议使用 * 匹配
3. 减少使用 .. 的形式描述包
4. **对接口进行描述**，使用 * 表示模块名，例如`UserService`的匹配描述为`*Service`
5. 方法名书写保留动词，例如get，使用 * 表示名词，例如`getById`匹配描述为`getBy*`
6. 参数根据实际情况灵活调整

##### 通知类型

- 前置通知

- 后置通知

- 环绕通知

  - 环绕通知可以模拟其他通知
    - 前置通知：在原始方法调用前执行
    - 后置通知：在`try catch finaly`中，在`finaly`后调用执行
    - 返回后通知：在`try catch finaly`中，try的大括号之前，原始调用之后执行
    - 抛出异常后通知：在`try catch finaly`中，catch的大括号里执行

  - 环绕通知依赖形参`ProceedingJoinPoint`才能实现对原始方法的调用

    该形参在该方法的形参列中必须在第一位

  - 环绕通知可以隔离原始方法的调用执行

  - 环绕通知返回值设置为`Object`类型

  - 环绕通知中可以对原始方法调用过程中出现的异常进行处理

- 返回后通知

- 抛出异常后通知

##### 获取数据

- 获取切入点方法的参数
  - `JoinPoint`：适用于前置、后置、返回后、抛出异常后通知，设置为方法的第一个形参
  - `ProceedingJoinPoint`：适用于环绕通知
- 获取切入点方法的返回值
  - 返回后通知
  - 环绕通知
- 获取切入点方法运行异常信息
  - 抛出异常后通知
  - 环绕通知